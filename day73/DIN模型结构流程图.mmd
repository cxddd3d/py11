graph TD
    A["ğŸ“Š æ•°æ®å‡†å¤‡"] --> A1["è®­ç»ƒæ•°æ®é›†<br/>trainingSamples.csv"]
    A --> A2["æµ‹è¯•æ•°æ®é›†<br/>testSamples.csv"]
    A1 --> A3["tf.data CSVæ•°æ®é›†"]
    A2 --> A3

    B["ğŸ”§ è¾“å…¥ç‰¹å¾å®šä¹‰"] --> B1["æ•°å€¼ç‰¹å¾<br/>movieAvgRating<br/>userAvgRatingç­‰"]
    B --> B2["IDç‰¹å¾<br/>movieId, userId<br/>userRatedMovie1-5"]
    B --> B3["ç±»åˆ«ç‰¹å¾<br/>userGenre1-5<br/>movieGenre1-3"]

    C["âš™ï¸ ç‰¹å¾å·¥ç¨‹"] --> C1["ç”¨æˆ·IDåµŒå…¥<br/>30001â†’10ç»´"]
    C --> C2["ç±»å‹åµŒå…¥<br/>19ä¸ªç±»å‹â†’10ç»´"]
    C --> C3["æ•°å€¼ç‰¹å¾<br/>ç›´æ¥ä½¿ç”¨"]

    D["ğŸ“‹ ç‰¹å¾å±‚æ„å»º"] --> D1["å€™é€‰ç”µå½±å±‚<br/>movieId"]
    D --> D2["ç”¨æˆ·è¡Œä¸ºå±‚<br/>æœ€è¿‘5éƒ¨ç”µå½±ID"]
    D --> D3["ç”¨æˆ·ç”»åƒå±‚<br/>ç”¨æˆ·åµŒå…¥+ç»Ÿè®¡"]
    D --> D4["ä¸Šä¸‹æ–‡å±‚<br/>ç”µå½±å±æ€§"]

    E["ğŸ¯ DINæ³¨æ„åŠ›æœºåˆ¶"] --> E1["ç”µå½±åµŒå…¥å±‚<br/>1001Ã—10ç»´"]
    E1 --> E2["ç”¨æˆ·å†å²åµŒå…¥<br/>(None,5,10)"]
    E1 --> E3["å€™é€‰ç”µå½±åµŒå…¥<br/>(None,10)"]

    E3 --> E4["é‡å¤å‘é‡<br/>(None,5,10)"]
    E2 --> E5["æ¿€æ´»å•å…ƒè®¡ç®—"]
    E4 --> E5

    E5 --> E6["ç›¸å‡æ“ä½œ<br/>Subtract"]
    E5 --> E7["ç›¸ä¹˜æ“ä½œ<br/>Multiply"]
    E6 --> E8["ç‰¹å¾æ‹¼æ¥<br/>40ç»´å‘é‡"]
    E7 --> E8
    E2 --> E8
    E4 --> E8

    E8 --> E9["Dense(32)+PReLU"]
    E9 --> E10["Dense(1)+Sigmoid<br/>æ³¨æ„åŠ›æƒé‡"]
    E10 --> E11["æƒé‡é‡å¡‘<br/>RepeatVector+Permute"]
    E11 --> E12["åŠ æƒå†å²è¡Œä¸º<br/>Multiply"]
    E12 --> E13["Sum Pooling<br/>(None,10)"]

    F["ğŸ”— ç‰¹å¾èåˆ"] --> F1["æ‰€æœ‰ç‰¹å¾æ‹¼æ¥<br/>ç”¨æˆ·ç”»åƒ+è¡Œä¸º+å€™é€‰+ä¸Šä¸‹æ–‡"]
    D1 --> F1
    D3 --> F1
    E13 --> F1
    D4 --> F1

    G["ğŸ§  è¾“å‡ºå±‚"] --> G1["Dense(128)+PReLU"]
    F1 --> G1
    G1 --> G2["Dense(64)+PReLU"]
    G2 --> G3["Dense(1)+Sigmoid<br/>CTRé¢„æµ‹"]

    H["ğŸ“ˆ æ¨¡å‹è®­ç»ƒ"] --> H1["æŸå¤±å‡½æ•°<br/>binary_crossentropy"]
    H --> H2["ä¼˜åŒ–å™¨<br/>adam"]
    H --> H3["è¯„ä¼°æŒ‡æ ‡<br/>accuracy, ROC-AUC, PR-AUC"]
    G3 --> H

    H --> I["è®­ç»ƒ5ä¸ªepochs"]
    I --> J["æ¨¡å‹è¯„ä¼°ä¸é¢„æµ‹"]

    classDef dataNode fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef featureNode fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef attentionNode fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef modelNode fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px

    class A,A1,A2,A3 dataNode
    class B,B1,B2,B3,C,C1,C2,C3,D,D1,D2,D3,D4 featureNode
    class E,E1,E2,E3,E4,E5,E6,E7,E8,E9,E10,E11,E12,E13 attentionNode
    class F,F1,G,G1,G2,G3,H,H1,H2,H3,I,J modelNode